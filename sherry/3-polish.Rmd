---
title: "3-polish"
author: "Huize Zhang"
date: "25/02/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(foreach)
library(doFuture)
registerDoFuture()
plan(multicore)
load(here::here("sherry", "data", "geodesic_polished.rda"))
load(here::here("sherry", "data", "geodesic_alpha2.rda"))
```

## Preliminary 

- I write a `search_polish()` function aiming to fining the global maximum after using `search_geodesic()`. This is implemented inside the `animate()` function. 

However, using it on the simulated data `geodesic_alpha` from `2-alpha_analysis` shows that the algorithm is not effective on picking the global maximum, see below:

```{r}
geodesic_clean <- geodesic_polished %>%
  filter(info %in% c("interpolation", "interpolation_polish")) %>%
  mutate(stepS = as.factor(stepS))

geodesic_interp <- geodesic_clean %>%
  group_by(stepS, polish_alpha) %>%
  mutate(id = row_number())

best <- geodesic_clean %>%
  group_by(stepS, polish_alpha, info) %>%
  mutate(id = row_number()) %>%
  filter(index_val == max(index_val))

geodesic_interp %>%
  ggplot(aes(x = id, y = index_val, col = info, group = stepS)) +
  geom_path() +
  ggrepel::geom_text_repel(data = best, aes(label = round(index_val, 4))) +
  facet_grid(stepS ~ polish_alpha)

```

Adding the polish step doesn't find a better basis for all the step_polish value and all the alpha value. This makes me want to understand more on how the ending interpolation bases locate for different alpha value. 








